import{a as h,o as e,w as W}from"./chunk-QMGIS6GS-DqORk8pi.js";import{L as A}from"./Loading-DDn8iYM2.js";import{u as w,a8 as F,a9 as L,aa as E,ab as B,i as I,ac as Q,ad as $,ae as M,af as N}from"./link-C8-_o7Eo.js";import{D as O,B as g,T as v,L as U,a as G}from"./Table-duDDh2PH.js";import{F as k,I as H,a as J,b as q,M as K}from"./ManageLayout-CE4D5ZmR.js";import{A as V}from"./AddProgramDialog-CrBatC6a.js";import{R as X,F as D,a as R}from"./RadioGroup-CGfNxVWm.js";import{W as Y}from"./WorkspaceDialog-BEBuOvAX.js";import{C as Z}from"./types-DQoDme26.js";import"./index-DiSreKSV.js";import"./ProgramDialog-D2KYgYn5.js";import"./Select-BIvNc4bb.js";import"./List-CJcBbO-e.js";const C={container:{width:"100%"},field:{marginBottom:"10px"}};function _({open:i,setOpen:r,workspace:c}){const n=w(),[o,{}]=F(),[d,s]=h.useState(""),[j,p]=h.useState("facilitator"),[f,u]=h.useState(""),l=x=>{r(x),u(""),s(""),p("facilitator")},S=async()=>{if(d==""){u("Please enter a valid email");return}try{await o({workspaceId:c.id,email:d,relationName:j}).unwrap()}catch(x){u(`Failed to add access: ${JSON.stringify(x)}`);return}l(!1)};return e.jsx(O,{open:i,setOpen:l,title:"Add Access",renderActions:()=>e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:S,children:"Save"}),e.jsx(g,{onClick:()=>l(!1),children:"Close"})]}),children:e.jsxs("div",{style:C.container,children:[e.jsx("div",{style:C.field,children:e.jsxs(k,{variant:"standard",fullWidth:!0,children:[e.jsx(H,{htmlFor:"email",children:"Email"}),e.jsx(J,{id:"email",fullWidth:!0,autoFocus:!0,placeholder:"Enter email",value:d,onInput:x=>s(x.target.value)})]})}),e.jsx("div",{style:C.field,children:e.jsxs(k,{children:[e.jsx(q,{id:"demo-radio-buttons-group-label",children:"Role"}),e.jsxs(X,{id:"role","aria-labelledby":"demo-radio-buttons-group-label",name:"radio-buttons-group",value:j,onChange:x=>p(x.target.value),children:[e.jsx(D,{value:"facilitator",control:e.jsx(R,{}),label:"Facilitator"}),e.jsx(D,{value:"admin",control:e.jsx(R,{}),label:"Admin"})]})]})}),e.jsx("div",{style:{color:n.colors3.error,fontSize:n.font.sizes.lower2},children:f})]})})}function ee({open:i,setOpen:r,workspace:c}){const[n,{}]=L();return e.jsx(Y,{open:i,setOpen:r,predefinedWorkspace:c,onSave:async({name:o})=>{await n({id:c.id,name:o}).unwrap()}})}const m={table:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:"24px"},card:{border:"2px solid",borderRadius:"12px",padding:"24px",background:"#ffffff",display:"flex",flexDirection:"column",justifyContent:"space-between"},header:{marginBottom:"16px"},name:{fontSize:"1.25rem",margin:"0 0 8px"},price:{fontSize:"2rem",fontWeight:"bold",marginBottom:"8px"},description:{color:"#6b7280",margin:"0"},button:{marginTop:"24px",padding:"12px",borderRadius:"8px",border:"none",fontSize:"1rem",color:"white"},badge:{display:"inline-block",color:"white",fontSize:"0.75rem",padding:"4px 8px",borderRadius:"999px",marginBottom:"8px"}},se=({plans:i,activePlan:r,onSubscribe:c})=>{const n=w();return e.jsx("div",{style:m.table,children:i.map(o=>e.jsxs("div",{style:{...m.card,borderColor:o.id===r?n.colors3.actionPrimary:n.colors3.divider},children:[e.jsxs("div",{children:[o.popular&&e.jsx("span",{style:{...m.badge,background:n.colors3.navBackground,color:n.colors3.navText},children:"Most Popular"}),e.jsxs("div",{style:m.header,children:[e.jsx("h3",{style:m.name,children:o.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("div",{style:m.price,children:o.price}),e.jsxs("div",{style:{fontSize:n.font.sizes.lower2,color:n.colors3.text3,lineHeight:"1.2"},children:["per",e.jsx("br",{}),"month"]})]}),o.description.map((d,s)=>e.jsx("p",{style:m.description,children:d},s))]})]}),e.jsx("button",{style:{...m.button,cursor:o.id===r?"default":"pointer",background:o.id===r?n.colors3.divider:n.colors3.actionPrimary,color:o.id===r?n.colors3.text3:"white"},onClick:()=>c(o.id),disabled:o.id===r,children:o.id===r?"Subscribed":"Subscribe"})]},o.id))})},te=[{id:"free",name:"Free Plan",price:"$0",description:["100 QR scans per month.","Suitable for 2 users and 20 sessions per month."],popular:!1},{id:"workshop",name:"Workshop Plan",price:"$10",description:["1000 QR scans per month.","Suitable for 20 users and 20 sessions per month."],popular:!1},{id:"seminar",name:"Seminar Plan",price:"$25",description:["3000 QR scans per month.","Suitable for 60 users and 20 sessions per month."],popular:!0},{id:"convention",name:"Convention Plan",price:"$40",description:["5000 QR scans per month.","Suitable for 120 users and 20 sessions per month."],popular:!1}],oe={container:{width:"100%"}};function re({open:i,setOpen:r,workspace:c}){const[n]=E(),[o]=B(),d=p=>{r(p)},s=c.plan||"free",j=async p=>{var f,u;if(console.log("Subscribe to plan:",p),!c.plan){try{const l=await n({workspaceId:c.id,plan:p});(f=l.data)!=null&&f.url&&(window.location.href=l.data.url)}catch(l){console.error("Error creating checkout session:",l)}return}try{const l=await o({workspaceId:c.id,newPlan:p});(u=l.data)!=null&&u.url&&(window.location.href=l.data.url)}catch(l){console.error("Error creating portal session:",l)}};return e.jsx(O,{open:i,setOpen:d,title:"Subscription Plans",maxWidth:"lg",renderActions:()=>e.jsx(e.Fragment,{children:e.jsx(g,{onClick:()=>d(!1),children:"Close"})}),children:e.jsx("div",{style:oe.container,children:e.jsx(se,{plans:te,activePlan:s,onSubscribe:j})})})}const t={container:{width:"100%",display:"flex",flexDirection:"column"},titleRow:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"20px",marginLeft:"16px",marginRight:"16px"},title:{},actionbar:{display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:"5px"},detailsTable:{textAlign:"left",marginLeft:"16px",marginRight:"16px"},detailsLabel:{fontWeight:"bold"},section:{width:"100%",display:"flex",flexDirection:"column",marginTop:"30px",borderTop:"1px solid",paddingTop:"20px",minHeight:"100px"},sectionTitleRow:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"5px",marginLeft:"16px",marginRight:"16px"},sectionTitle:{fontWeight:"bold"},lastColumn:{display:"flex",flexDirection:"row",justifyContent:"end"}};function ie({workspace:i,programs:r,organizers:c,resources:n,relationName:o,capabilities:d}){const s=w(),j=I(),[p,f]=h.useState(!1),[u,l]=h.useState(!1),[S,x]=h.useState(!1),[P,z]=h.useState(!1),b={...t.section,borderColor:s.colors3.divider},T=i.plan||"free";return e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.titleRow,children:[e.jsx("div",{style:{...t.title,color:s.colors3.text1,fontSize:s.font.sizes.h1},children:i.name}),e.jsx("div",{style:t.actionbar,children:d.hasCapability("editWorkspace")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>f(!0),children:"Edit"}),e.jsx(ee,{open:p,setOpen:f,workspace:i})]})})]}),e.jsx("table",{style:t.detailsTable,children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{...t.detailsLabel,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Role"}),e.jsx("td",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:o})]})})}),e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Subscription"}),e.jsx("div",{style:t.actionbar,children:d.hasCapability("manageBilling")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>z(!0),children:"Change Subscription"}),e.jsx(re,{open:P,setOpen:z,workspace:i})]})})]}),e.jsx("table",{style:t.detailsTable,children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Plan"}),e.jsx("td",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:T})]})})})]}),e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Usage"}),e.jsx("div",{style:t.actionbar})]}),e.jsx(v,{data:n,fields:["resource","usage"],getId:a=>a.name,renderCell:(a,y)=>{switch(y){case"resource":return e.jsx("div",{children:a.name});case"usage":return e.jsxs("div",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:[a.used," / ",a.limit]})}}})]}),e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Programs"}),e.jsx("div",{style:t.actionbar,children:d.hasCapability("addProgram")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>l(!0),children:"Add"}),e.jsx(V,{open:u,setOpen:l,predefinedWorkspace:i})]})})]}),e.jsx(v,{data:r,fields:["program","scan"],getId:a=>a.id,renderCell:(a,y)=>{switch(y){case"program":return e.jsx(U,{href:j(a),style:{...t.program,color:s.colors3.text1,textDecorationColor:s.colors3.text1,textUnderlineOffset:s.font.sizes.textUnderlineOffset,fontSize:s.font.sizes.normal},children:a.name});case"role":return e.jsx("div",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1}})}}})]}),e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Access"}),e.jsx("div",{style:t.actionbar,children:d.hasCapability("manageOrganizers")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>x(!0),children:"Add"}),e.jsx(_,{open:S,setOpen:x,workspace:i})]})})]}),e.jsx(v,{data:c,fields:["user","role"],getId:a=>a.user.id,renderCell:(a,y)=>{switch(y){case"user":return e.jsxs("div",{children:[e.jsx("div",{style:{color:s.colors3.text1,fontSize:s.font.sizes.normal},children:a.user.name}),e.jsx("div",{style:{color:s.colors3.text2,fontSize:s.font.sizes.lower2},children:a.user.email})]});case"role":return e.jsx("div",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:a.relationName})}}})]})]})}function ne({workspaceId:i}){const{data:r}=Q(i),{data:c=[]}=$(i),{data:n=[]}=M(i),{data:o=[]}=N(i);return r==null?e.jsx(A,{}):e.jsx(G,{currentPage:"manage",children:e.jsx(K,{currentPage:"workspaces",children:e.jsx(ie,{workspace:r.workspace,programs:c,organizers:o,resources:n,relationName:r.relationName,capabilities:new Z(r.capabilities)})})})}const be=W(function({params:r}){return e.jsx(ne,{workspaceId:r.workspaceId})});export{be as default};

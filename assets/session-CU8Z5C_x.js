import{a as p,o as t,w as X}from"./chunk-QMGIS6GS-DqORk8pi.js";import{L as Y}from"./Loading-DDn8iYM2.js";import{m as G,F as N,G as Z,H as U,I as F,l as E,J as O,K as V,M as _,N as H,O as ee,y as Q,u as J,Q as te,R as oe,v as se,i as re,S as ne,U as ie}from"./link-C8-_o7Eo.js";import{D as le,B as k,T as P,a as ae}from"./Table-duDDh2PH.js";import{F as I,I as de,M as ce}from"./ManageLayout-CE4D5ZmR.js";import{u as ue}from"./types-DQoDme26.js";import{S as pe,M as fe}from"./Select-BIvNc4bb.js";import{d as A,L as xe,A as ge,D as he,S as ve}from"./SessionDialog-g7j2MoLq.js";import{f as me}from"./formatDuration-DSjjpX6K.js";import{S as ye}from"./ScanDialog-CbVRp-B1.js";import"./index-DiSreKSV.js";import"./List-CJcBbO-e.js";import"./index-HK61iSnx.js";import"./ListItem-ALYhS3Y6.js";function je(e){return p.Children.toArray(e).filter(o=>p.isValidElement(o))}function Ce(e){return N("MuiToggleButton",e)}const T=G("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),K=p.createContext({}),q=p.createContext(void 0);function be(e,o){return o===void 0||e===void 0?!1:Array.isArray(o)?o.includes(e):e===o}const Se=e=>{const{classes:o,fullWidth:r,selected:c,disabled:u,size:a,color:d}=e,s={root:["root",c&&"selected",u&&"disabled",r&&"fullWidth",`size${O(a)}`,d]};return V(s,Ce,o)},Be=F(_,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,o[`size${O(r.size)}`]]}})(H(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${T.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${T.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(ee()).map(([o])=>({props:{color:o},style:{[`&.${T.selected}`]:{color:(e.vars||e).palette[o].main,backgroundColor:e.alpha((e.vars||e).palette[o].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[o].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[o].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),M=p.forwardRef(function(o,r){const{value:c,...u}=p.useContext(K),a=p.useContext(q),d=Z({...u,selected:be(o.value,c)},o),s=U({props:d,name:"MuiToggleButton"}),{children:m,className:y,color:v="standard",disabled:C=!1,disableFocusRipple:b=!1,fullWidth:l=!1,onChange:z,onClick:S,selected:h,size:f="medium",value:x,...w}=s,j={...s,color:v,disabled:C,disableFocusRipple:b,fullWidth:l,size:f},R=Se(j),W=g=>{S&&(S(g,x),g.defaultPrevented)||z&&z(g,x)},B=a||"";return t.jsx(Be,{className:E(u.className,R.root,y,B),disabled:C,focusRipple:!b,ref:r,onClick:W,onChange:z,value:x,ownerState:j,"aria-pressed":h,...w,children:m})});function ze(e){return N("MuiToggleButtonGroup",e)}const n=G("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),we=e=>{const{classes:o,orientation:r,fullWidth:c,disabled:u}=e,a={root:["root",r,c&&"fullWidth"],grouped:["grouped",`grouped${O(r)}`,u&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return V(a,ze,o)},Te=F("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[{[`& .${n.grouped}`]:o.grouped},{[`& .${n.grouped}`]:o[`grouped${O(r.orientation)}`]},{[`& .${n.firstButton}`]:o.firstButton},{[`& .${n.lastButton}`]:o.lastButton},{[`& .${n.middleButton}`]:o.middleButton},o.root,r.orientation==="vertical"&&o.vertical,r.fullWidth&&o.fullWidth]}})(H(({theme:e})=>({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${n.grouped}`]:{[`&.${n.selected} + .${n.grouped}.${n.selected}`]:{borderTop:0,marginTop:0}},[`& .${n.firstButton},& .${n.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${n.lastButton},& .${n.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${n.lastButton}.${T.disabled},& .${n.middleButton}.${T.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${n.grouped}`]:{[`&.${n.selected} + .${n.grouped}.${n.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${n.firstButton},& .${n.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${n.lastButton},& .${n.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${n.lastButton}.${T.disabled},& .${n.middleButton}.${T.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),Re=p.forwardRef(function(o,r){const c=U({props:o,name:"MuiToggleButtonGroup"}),{children:u,className:a,color:d="standard",disabled:s=!1,exclusive:m=!1,fullWidth:y=!1,onChange:v,orientation:C="horizontal",size:b="medium",value:l,...z}=c,S={...c,disabled:s,fullWidth:y,orientation:C,size:b},h=we(S),f=p.useCallback((B,g)=>{if(!v)return;const $=l&&l.indexOf(g);let D;l&&$>=0?(D=l.slice(),D.splice($,1)):D=l?l.concat(g):[g],v(B,D)},[v,l]),x=p.useCallback((B,g)=>{v&&v(B,l===g?null:g)},[v,l]),w=p.useMemo(()=>({className:h.grouped,onChange:m?x:f,value:l,size:b,fullWidth:y,color:d,disabled:s}),[h.grouped,m,x,f,l,b,y,d,s]),j=je(u),R=j.length,W=B=>{const g=B===0,$=B===R-1;return g&&$?"":g?h.firstButton:$?h.lastButton:h.middleButton};return t.jsx(Te,{role:"group",className:E(h.root,a),ref:r,ownerState:S,...z,children:t.jsx(K.Provider,{value:w,children:j.map((B,g)=>t.jsx(q.Provider,{value:W(g),children:B},g))})})});function $e({id:e,program:o,value:r,onChange:c,disabled:u=!1}){const{data:a=[]}=Q(o.id);console.log("InviteeSelector invitees:",a);const d=s=>{const m=a.find(y=>y.user.id===s.target.value);if(!m){console.error("Invitee not found for id:",s.target.value);return}c(m)};return t.jsx(pe,{id:e,value:r==null?void 0:r.user.id,label:"Invitee",onChange:d,disabled:u,children:a.map(s=>t.jsx(fe,{value:s.user.id,children:ue(s.user)},s.user.id))})}const L={container:{width:"100%"},field:{marginBottom:"10px"}};function ke({open:e,setOpen:o,session:r,program:c}){const u=J(),[a,{}]=te(),[d,s]=p.useState(""),[m,y]=p.useState(A()),[v,C]=p.useState(null),[b,l]=p.useState(""),[z,S]=p.useState(null),h=x=>{o(x),l(""),s(""),y(A()),C(null),S(null)},f=async()=>{if(v==null){l("Please select an invitee");return}if(d!=="checkin"&&d!=="checkout"){l("Please select check in or check out");return}try{a({badgeSignedValue:v.badge.signedValue,sessionId:r.id,state:d,createdAt:m.toISOString()})}catch(x){l(`Failed to add record: ${JSON.stringify(x)}`);return}h(!1)};return t.jsx(le,{open:e,setOpen:h,title:"Add Record",renderActions:()=>t.jsxs(t.Fragment,{children:[t.jsx(k,{onClick:f,children:"Save"}),t.jsx(k,{onClick:()=>h(!1),children:"Close"})]}),children:t.jsxs("div",{style:L.container,children:[t.jsx("div",{style:L.field,children:t.jsxs(I,{variant:"standard",fullWidth:!0,children:[t.jsx(de,{htmlFor:"invitee",children:"Invitee"}),t.jsx($e,{id:"invitee",value:v,onChange:C,program:c})]})}),t.jsx("div",{style:L.field,children:t.jsx(I,{variant:"standard",fullWidth:!0,children:t.jsxs(Re,{id:"state",fullWidth:!0,color:"primary",value:d,exclusive:!0,onChange:x=>s(x.target.value),children:[t.jsx(M,{value:"checkin",children:"Check in"}),t.jsx(M,{value:"checkout",children:"Check out"})]})})}),t.jsx("div",{style:L.field,children:t.jsx(I,{variant:"standard",fullWidth:!0,children:t.jsx(xe,{dateAdapter:ge,children:t.jsx(he,{value:m,onChange:x=>y(x)})})})}),t.jsx("div",{style:{color:u.colors3.error,fontSize:u.font.sizes.lower2},children:b})]})})}function De({open:e,setOpen:o,predefinedProgram:r,session:c}){const[u,{}]=oe();return t.jsx(ve,{open:e,setOpen:o,predefinedProgram:r,predefinedSession:c,onSave:async({name:a,programId:d,happensAt:s})=>{await u({id:c.id,name:a,programId:d,happensAt:s}).unwrap()}})}function Le(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}const i={container:{width:"100%",display:"flex",flexDirection:"column"},titleRow:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"20px",marginLeft:"16px",marginRight:"16px"},title:{},actionbar:{display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:"5px"},detailsTable:{textAlign:"left",marginLeft:"16px",marginRight:"16px"},detailsLabel:{fontWeight:"bold"},detailsLink:{textDecoration:"underline"},section:{width:"100%",display:"flex",flexDirection:"column",marginTop:"30px",borderTop:"1px solid",paddingTop:"20px",minHeight:"100px"},sectionTitleRow:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"5px",marginLeft:"16px",marginRight:"16px"},sectionTitle:{fontWeight:"bold"},lastColumn:{display:"flex",flexDirection:"row",justifyContent:"end"}};function Oe({session:e,program:o,workspace:r,invitees:c,inviteeInsights:u,records:a,relationName:d}){const s=J(),m=se(),y=re(),[v,C]=p.useState(!1),[b,l]=p.useState(!1),[z,S]=p.useState(!1),h={...i.section,borderColor:s.colors3.divider};return t.jsxs("div",{style:i.container,children:[t.jsxs("div",{style:i.titleRow,children:[t.jsx("div",{style:{...i.title,color:s.colors3.text1,fontSize:s.font.sizes.h1},children:e.name}),t.jsxs("div",{style:i.actionbar,children:[t.jsx(k,{onClick:()=>l(!0),children:"Scan"}),t.jsx(ye,{open:b,setOpen:l,session:e}),t.jsx(k,{onClick:()=>C(!0),children:"Edit"}),t.jsx(De,{open:v,setOpen:C,predefinedProgram:o,session:e})]})]}),t.jsx("table",{style:i.detailsTable,children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{style:{...i.detailsLabel,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Program"}),t.jsx("td",{children:t.jsx("a",{href:o?y(o):"",style:{...i.detailsLink,...i.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1,textDecorationColor:s.colors3.text1,textUnderlineOffset:s.font.sizes.textUnderlineOffset},children:o==null?void 0:o.name})})]}),t.jsxs("tr",{children:[t.jsx("td",{style:{...i.detailsLabel,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Workspace"}),t.jsx("td",{children:t.jsx("a",{href:m(r),style:{...i.detailsLink,...i.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1,textDecorationColor:s.colors3.text1,textUnderlineOffset:s.font.sizes.textUnderlineOffset},children:r.name})})]}),t.jsxs("tr",{children:[t.jsx("td",{style:{...i.detailsLabel,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Role"}),t.jsx("td",{style:{...i.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:d})]}),t.jsxs("tr",{children:[t.jsx("td",{style:{...i.detailsLabel,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"When"}),t.jsx("td",{style:{...i.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:Le(e.happensAt)})]})]})}),t.jsxs("section",{style:h,children:[t.jsxs("div",{style:i.sectionTitleRow,children:[t.jsx("div",{style:{...i.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Invitees"}),t.jsx("div",{style:i.actionbar})]}),t.jsx(P,{data:u,fields:["invitee","insight"],getId:f=>f.user.id,renderCell:(f,x)=>{switch(x){case"invitee":return t.jsxs("div",{children:[t.jsx("div",{style:{color:s.colors3.text1,fontSize:s.font.sizes.normal},children:f.user.name}),t.jsx("div",{style:{color:s.colors3.text2,fontSize:s.font.sizes.lower2},children:f.user.email})]});case"insight":return t.jsx("div",{style:{...i.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:me(f.totalDurationSeconds)})}}})]}),t.jsxs("section",{style:h,children:[t.jsxs("div",{style:i.sectionTitleRow,children:[t.jsx("div",{style:{...i.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Records"}),t.jsxs("div",{style:i.actionbar,children:[t.jsx(k,{onClick:()=>S(!0),children:"Add"}),t.jsx(ke,{open:z,setOpen:S,session:e,program:o})]})]}),t.jsx(P,{data:a,fields:["user","state","time"],getId:f=>f.id,renderCell:(f,x)=>{switch(x){case"user":const w=c.find(R=>R.user.id===f.userId),j=w==null?void 0:w.user;return t.jsxs("div",{children:[t.jsx("div",{style:{color:s.colors3.text1,fontSize:s.font.sizes.normal},children:j==null?void 0:j.name}),t.jsx("div",{style:{color:s.colors3.text2,fontSize:s.font.sizes.lower2},children:j==null?void 0:j.email})]});case"state":return t.jsx("div",{style:{color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:Ie(f.state)});case"time":return t.jsx("div",{style:{...i.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:We(new Date(f.createdAt))})}}})]})]})}function We(e){return new Intl.DateTimeFormat("en",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}).format(e)}function Ie(e){switch(e){case"checkin":return"Check in";case"checkout":return"Check out";default:return""}}function Pe({sessionId:e}){var a,d;const{data:o=null}=ne({sessionId:e}),{data:{inviteeInsights:r=[],records:c=[]}={}}=ie(e),{data:u=[]}=Q(((a=o==null?void 0:o.program)==null?void 0:a.id)||"",{skip:!((d=o==null?void 0:o.program)!=null&&d.id)});return o==null?t.jsx(Y,{}):t.jsx(ae,{currentPage:"manage",children:t.jsx(ce,{currentPage:"sessions",children:t.jsx(Oe,{session:o.session,program:o.program,workspace:o.workspace,invitees:u,inviteeInsights:r,records:c,relationName:o.relationName})})})}const Ye=X(function({params:o}){return t.jsx(Pe,{sessionId:o.sessionId})});export{Ye as default};

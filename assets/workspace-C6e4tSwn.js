import{a as h,o as e,w as T}from"./chunk-QMGIS6GS-DqORk8pi.js";import{L as A}from"./Loading-DDn8iYM2.js";import{u as C,ab as F,ac as L,ad as E,ae as B,i as I,af as Q,ag as $,ah as M,ai as N,aj as U,E as G}from"./link-DLQH289a.js";import{C as H}from"./types-B02bDBLB.js";import{D as R,B as g,T as v,L as J,a as Y}from"./Table-CNeg-TMI.js";import{F as k,I as q,a as K,b as V,M as X}from"./ManageLayout-t3KEE2G7.js";import{A as Z}from"./AddProgramDialog-HH0VToXG.js";import{R as _,F as O,a as D}from"./RadioGroup-CXywcPIy.js";import{W as ee}from"./WorkspaceDialog-HAFxxWpt.js";import"./index-DiSreKSV.js";import"./ProgramDialog-BE8b8mgL.js";import"./Select-CXKZpMUJ.js";import"./List-qEd4ucO3.js";const w={container:{width:"100%"},field:{marginBottom:"10px"}};function se({open:i,setOpen:r,workspace:d}){const n=C(),[o,{}]=F(),[a,s]=h.useState(""),[j,p]=h.useState("facilitator"),[f,u]=h.useState(""),l=x=>{r(x),u(""),s(""),p("facilitator")},S=async()=>{if(a==""){u("Please enter a valid email");return}try{await o({workspaceId:d.id,email:a,relationName:j}).unwrap()}catch(x){u(`Failed to add access: ${JSON.stringify(x)}`);return}l(!1)};return e.jsx(R,{open:i,setOpen:l,title:"Add Organizer",renderActions:()=>e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:S,children:"Save"}),e.jsx(g,{onClick:()=>l(!1),children:"Close"})]}),children:e.jsxs("div",{style:w.container,children:[e.jsx("div",{style:w.field,children:e.jsxs(k,{variant:"standard",fullWidth:!0,children:[e.jsx(q,{htmlFor:"email",children:"Email"}),e.jsx(K,{id:"email",fullWidth:!0,autoFocus:!0,placeholder:"Enter email",value:a,onInput:x=>s(x.target.value)})]})}),e.jsx("div",{style:w.field,children:e.jsxs(k,{children:[e.jsx(V,{id:"demo-radio-buttons-group-label",children:"Role"}),e.jsxs(_,{id:"role","aria-labelledby":"demo-radio-buttons-group-label",name:"radio-buttons-group",value:j,onChange:x=>p(x.target.value),children:[e.jsx(O,{value:"facilitator",control:e.jsx(D,{}),label:"Facilitator"}),e.jsx(O,{value:"admin",control:e.jsx(D,{}),label:"Admin"})]})]})}),e.jsx("div",{style:{color:n.colors3.error,fontSize:n.font.sizes.lower2},children:f})]})})}function te({open:i,setOpen:r,workspace:d}){const[n,{}]=L();return e.jsx(ee,{open:i,setOpen:r,predefinedWorkspace:d,onSave:async({name:o})=>{await n({id:d.id,name:o}).unwrap()}})}const m={table:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:"24px"},card:{border:"2px solid",borderRadius:"12px",padding:"24px",background:"#ffffff",display:"flex",flexDirection:"column",justifyContent:"space-between"},header:{marginBottom:"16px"},name:{fontSize:"1.25rem",margin:"0 0 8px"},price:{fontSize:"2rem",fontWeight:"bold",marginBottom:"8px"},description:{color:"#6b7280",margin:"0"},button:{marginTop:"24px",padding:"12px",borderRadius:"8px",border:"none",fontSize:"1rem",color:"white"},badge:{display:"inline-block",color:"white",fontSize:"0.75rem",padding:"4px 8px",borderRadius:"999px",marginBottom:"8px"}},oe=({plans:i,activePlan:r,onSubscribe:d})=>{const n=C();return e.jsx("div",{style:m.table,children:i.map(o=>e.jsxs("div",{style:{...m.card,borderColor:o.id===r?n.colors3.actionPrimary:n.colors3.divider},children:[e.jsxs("div",{children:[o.popular&&e.jsx("span",{style:{...m.badge,background:n.colors3.navBackground,color:n.colors3.navText},children:"Most Popular"}),e.jsxs("div",{style:m.header,children:[e.jsx("h3",{style:m.name,children:o.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("div",{style:m.price,children:o.price}),e.jsxs("div",{style:{fontSize:n.font.sizes.lower2,color:n.colors3.text3,lineHeight:"1.2"},children:["per",e.jsx("br",{}),"month"]})]}),o.description.map((a,s)=>e.jsx("p",{style:m.description,children:a},s))]})]}),e.jsx("button",{style:{...m.button,cursor:o.id===r?"default":"pointer",background:o.id===r?n.colors3.divider:n.colors3.actionPrimary,color:o.id===r?n.colors3.text3:"white"},onClick:()=>d(o.id),disabled:o.id===r,children:o.id===r?"Subscribed":"Subscribe"})]},o.id))})},re=[{id:"free",name:"Free Plan",price:"$0",description:["100 QR scans per month.","Suitable for 2 users and 20 sessions per month."],popular:!1},{id:"workshop",name:"Workshop Plan",price:"$10",description:["1000 QR scans per month.","Suitable for 20 users and 20 sessions per month."],popular:!1},{id:"seminar",name:"Seminar Plan",price:"$25",description:["3000 QR scans per month.","Suitable for 60 users and 20 sessions per month."],popular:!0},{id:"convention",name:"Convention Plan",price:"$40",description:["5000 QR scans per month.","Suitable for 120 users and 20 sessions per month."],popular:!1}],ie={container:{width:"100%"}};function ne({open:i,setOpen:r,workspace:d}){const[n]=E(),[o]=B(),a=p=>{r(p)},s=d.plan||"free",j=async p=>{var f,u;if(console.log("Subscribe to plan:",p),!d.plan){try{const l=await n({workspaceId:d.id,plan:p});(f=l.data)!=null&&f.url&&(window.location.href=l.data.url)}catch(l){console.error("Error creating checkout session:",l)}return}try{const l=await o({workspaceId:d.id,newPlan:p});(u=l.data)!=null&&u.url&&(window.location.href=l.data.url)}catch(l){console.error("Error creating portal session:",l)}};return e.jsx(R,{open:i,setOpen:a,title:"Subscription Plans",maxWidth:"lg",renderActions:()=>e.jsx(e.Fragment,{children:e.jsx(g,{onClick:()=>a(!1),children:"Close"})}),children:e.jsx("div",{style:ie.container,children:e.jsx(oe,{plans:re,activePlan:s,onSubscribe:j})})})}const t={container:{width:"100%",display:"flex",flexDirection:"column"},titleRow:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"20px",marginLeft:"16px",marginRight:"16px"},title:{},actionbar:{display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:"5px"},detailsTable:{textAlign:"left",marginLeft:"16px",marginRight:"16px"},detailsLabel:{fontWeight:"bold"},section:{width:"100%",display:"flex",flexDirection:"column",marginTop:"30px",borderTop:"1px solid",paddingTop:"20px",minHeight:"100px"},sectionTitleRow:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"5px",marginLeft:"16px",marginRight:"16px"},sectionTitle:{fontWeight:"bold"},lastColumn:{display:"flex",flexDirection:"row",justifyContent:"end"}};function ae({workspace:i,programs:r,organizers:d,resources:n,relationName:o,capabilities:a}){const s=C(),j=I(),[p,f]=h.useState(!1),[u,l]=h.useState(!1),[S,x]=h.useState(!1),[W,z]=h.useState(!1),b={...t.section,borderColor:s.colors3.divider},P=i.plan||"free";return e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.titleRow,children:[e.jsx("div",{style:{...t.title,color:s.colors3.text1,fontSize:s.font.sizes.h1},children:i.name}),e.jsx("div",{style:t.actionbar,children:a.hasCapability("editWorkspace")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>f(!0),children:"Edit"}),e.jsx(te,{open:p,setOpen:f,workspace:i})]})})]}),e.jsx("table",{style:t.detailsTable,children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{...t.detailsLabel,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Your role"}),e.jsx("td",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:o})]})})}),a.hasCapability("viewBilling")&&e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Subscription"}),e.jsx("div",{style:t.actionbar,children:a.hasCapability("manageBilling")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>z(!0),children:"Change Subscription"}),e.jsx(ne,{open:W,setOpen:z,workspace:i})]})})]}),e.jsx("table",{style:t.detailsTable,children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Plan"}),e.jsx("td",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:P})]})})})]}),a.hasCapability("viewBilling")&&e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Usage"}),e.jsx("div",{style:t.actionbar})]}),e.jsx(v,{data:n,fields:["resource","usage"],getId:c=>c.name,renderCell:(c,y)=>{switch(y){case"resource":return e.jsx("div",{children:c.name});case"usage":return e.jsxs("div",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:[c.used," / ",c.limit]})}}})]}),e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Programs"}),e.jsx("div",{style:t.actionbar,children:a.hasCapability("addProgram")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>l(!0),children:"Add"}),e.jsx(Z,{open:u,setOpen:l,predefinedWorkspace:i})]})})]}),e.jsx(v,{data:r,fields:["program","scan"],getId:c=>c.id,renderCell:(c,y)=>{switch(y){case"program":return e.jsx(J,{href:j(c),style:{...t.program,color:s.colors3.text1,textDecorationColor:s.colors3.text1,textUnderlineOffset:s.font.sizes.textUnderlineOffset,fontSize:s.font.sizes.normal},children:c.name});case"role":return e.jsx("div",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1}})}}})]}),e.jsxs("section",{style:b,children:[e.jsxs("div",{style:t.sectionTitleRow,children:[e.jsx("div",{style:{...t.sectionTitle,color:s.colors3.text1,fontSize:s.font.sizes.normal},children:"Organizers"}),e.jsx("div",{style:t.actionbar,children:a.hasCapability("manageOrganizers")&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>x(!0),children:"Add"}),e.jsx(se,{open:S,setOpen:x,workspace:i})]})})]}),e.jsx(v,{data:d,fields:["user","role"],getId:c=>c.user.id,renderCell:(c,y)=>{switch(y){case"user":return e.jsxs("div",{children:[e.jsx("div",{style:{color:s.colors3.text1,fontSize:s.font.sizes.normal},children:c.user.name}),e.jsx("div",{style:{color:s.colors3.text2,fontSize:s.font.sizes.lower2},children:c.user.email})]});case"role":return e.jsx("div",{style:{...t.lastColumn,color:s.colors3.text1,fontSize:s.font.sizes.lower1},children:c.relationName})}}})]})]})}function le({workspaceId:i}){const{data:r,error:d}=Q(i),{data:n=[]}=$(i),{data:o=[]}=M(i),{data:a=[]}=N(i),s=U();return G(d,s),r==null?e.jsx(A,{}):e.jsx(Y,{currentPage:"manage",children:e.jsx(X,{currentPage:"workspaces",children:e.jsx(ae,{workspace:r.workspace,programs:n,organizers:a,resources:o,relationName:r.workspace.relationName,capabilities:new H(r.workspace.capabilities)})})})}const ve=T(function({params:r}){return e.jsx(le,{workspaceId:r.workspaceId})});export{ve as default};
